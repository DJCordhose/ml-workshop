<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Workshop ML Apps</title>

    <meta name="description" content="Workshop ML Apps">
    <meta name="author" content="Oliver Zeigermann">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

          <link rel="stylesheet" href="reveal.js/css/reveal.css">
          <!--<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">-->
          <link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
      
          <!-- Code syntax highlighting -->
          <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
          <style>
              /*pre code {*/
                  /*display: block;*/
                  /*padding: 0.5em;*/
                  /*background: #FFFFFF !important;*/
                  /*color: #000000 !important;*/
              /*}*/
      
              .right-img {
                  margin-left: 10px !important;
                  float: right;
                  height: 500px;
              }
              .todo:before {
                  content: 'TODO: ';
              }
              .todo {
                  color: red !important;
              }
              code span.line-number {
                  color: lightcoral;
              }
              .reveal pre code {
                  max-height: 1000px !important;
              }
      
              img {
                  border: 0 !important;
                  box-shadow:0 0 0 0 !important;
              }
      
              .reveal {
                  -ms-touch-action: auto !important;
                  touch-action: auto !important;
                      }
      
                      .reveal h2,
                      .reveal h3,
                      .reveal h4 {
                        letter-spacing: 2px;
                        font-family: 'Calibri', sans-serif;
                          /* font-family: 'Times New Roman', Times, serif; */
                          font-weight: bold;
                          color: black;
                          font-style: italic;
                          letter-spacing: -2px;
                          text-transform: none !important;
                      }
      
                      .reveal em {
                          font-weight: bold;
                      }
      
                      .reveal .step-subtitle h1 {
                          letter-spacing: 1px;
                      }
                      .reveal .step-subtitle h2,
                      .reveal .step-subtitle h3 {
                          text-transform: none;
                          font-style: italic;
                          font-weight: normal;
                          /* font-weight: 400; */
                          /* font-family: 'Amiri', serif; */
                          font-family: 'Lobster', serif;
                          letter-spacing: 1px;
                          color: #2aa198;
                          text-decoration: underline;
                      }
      
                      .reveal .front-page h1,
                      .reveal .front-page h2 {
                          font-family: "League Gothic";
                          font-style: normal;
                          text-transform: uppercase !important;
                          letter-spacing: 1px;
                      }
      
                      .reveal .front-page h1 {
                          font-size: 2.5em !important;
                      }
      
                      .reveal .highlight {
                          background-color: #D3337B;
                          color: white;
                      }
      
              .reveal section img {
                background: none;
              }
      
                      .reveal img.with-border {
                          border: 1px solid #586e75 !important;
                          box-shadow: 3px 3px 1px rgba(0, 0, 0, 0.15) !important;
                      }
      
                      .reveal li {
                          margin-bottom: 8px;
                      }
      
                      /* For li's that use FontAwesome icons as bullet-point */
                  .reveal ul.fa-ul li {
                      list-style-type: none;
                  }

             .reveal {
                font-family: 'Calibri';
                color: black !important;
                /* font-size: xx-large; */
             }


          </style>
      
    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        var printMode = window.location.search.match(/print-pdf/gi);
        link.href = printMode ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body style="background-color: whitesmoke;">

<div class="reveal">
    <div class="slides">

        <!-- <section data-markdown class="todo">
<textarea data-template>
</textarea>
</section> -->

<section>
    <h2>Workshop Machine Learning Applications</h2>
    <h4><a href="http://zeigermann.eu">Oliver Zeigermann</a> / 
        <a href="http://twitter.com/djcordhose">@DJCordhose</a>
    </h4>
</section>

<!-- <section data-markdown style="font-size: xx-large;">
    <textarea data-template>
    
## Finding applications for machine learning        
### Two approaches

1. What data is available or can be obtained?
   * Data is of central importance in machine learning
   * On the basis of the available data one can derive possible directions for experiments
   * investigating what data is available and what business opportunities can be derived from it
1. Looking at Case Studies introducing different types of Machine Learning
   * What works for others may work for us
   * Companies with similar business models are particularly attractive
</textarea>
</section>


<section data-markdown>
<textarea data-template>
# Part 0

## Introduction

</textarea>
</section>
 -->

<section data-markdown>
    <textarea data-template>

### Classic Supervised Machine Learning: Learning from tabular data
</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Car Insurance: Predicting Crash Risk for prospective customers

<a href='html/calculator.html'>
<img src='img/insurance/calculator.png' height="400">
</a>
<p><small>
<a href='html/calculator.html' target="_blank">
https://djcordhose.github.io/ai/html/calculator.html</a></small>
</small></p>
</textarea>
</section>

<section data-markdown>
<textarea data-template>
## How to solve this programmatically?
</textarea>
</section>

<section data-markdown id='supervised-2'>
<textarea data-template>
<img src='img/classic-development.jpg'>
</textarea>
</section>


<section>
<h3>Programmer's approach: Code Rules by Hand</h3>
<div class="fragment">
<pre><code contenteditable data-trim class="line-numbers python">
def calculate_risk(age, speed):
if age < 25:
    if speed > 110:
        return high  # young people, fast cars
    else:
        return medium # young people
</code></pre>
</div>
<div class="fragment">
<pre><code contenteditable class="line-numbers python">    if age > 70:
    return high # seniors</code></pre>
</div>
<div class="fragment">
<pre><code contenteditable class="line-numbers python">    if speed > 145:
    return high # fast cars in general</code></pre>
</div>
<div class="fragment">
<pre><code contenteditable class="line-numbers python">    # this default vastly simplifies rule set    
return low # otherwise</code></pre>
</div>
</section>

<section data-markdown>
<textarea data-template>
### How good is this?

* Is it better than guessing?
* Are all the rules correct?
* Are some missing?
* How would we even know?
* How do we react when the market changes?
* Sometimes a change is not even obvious, but just creeping in 

</textarea>
</section>                    

<!-- <section data-markdown>
<textarea data-template>
### How good is our Rule based approach?

Plotting the predictions as a background

<img src='img/applications/rules.png' class="fragment" height="450px">
<br>
<small class="fragment">approx. 57% predictions correct</small>
</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Baseline to understand if our score is good

<img src="img/applications/random.png" height="450px"  class="fragment">

<small  class="fragment">only gets 33% right</small>
</textarea>
</section> -->

<section data-markdown>
<textarea data-template>
## Do we really have to write those rules by hand?
</textarea>
</section>

<section data-markdown>
<textarea data-template>
<img src='img/supervised-ml.jpg' height="650px">
</textarea>
</section>

<section>
<h3>Classification based on known data</h3>
<img src="img/applications/all.png" height="500px" class="fragment">
</section>

<section data-markdown>
<textarea data-template>
### Decision Trees can learn such rules

<img src="img/applications/tree_interp.png">
</textarea>
</section>


<section data-markdown>
<textarea data-template>
<!-- # Part I -->

## Data and business opportunities


</textarea>
</section>

<section data-markdown>
    <textarea data-template>
#### Role Models I: ML@Netflix

<img src='img/ml_at_netflix.jpg'>

</textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Role Models II: Tesla
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Traditional Development and Machine Learning melt into one        

<small>https://www.youtube.com/playlist?list=PLRM2gQVaW_wVM4FBALoM7Wydb6n9NOiJ0<br/>
https://youtu.be/hx7BXih7zx8
</small>
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
<img src='img/d2d/tesla-from-1-to-2.png' height="600">        
    </textarea>
</section>

<!-- <section data-markdown>
    <textarea data-template>
<img src='img/d2d/tesla-hydranet.png' height="600">        
    </textarea>
</section> -->

<section data-markdown>
    <textarea data-template>
<img src='img/d2d/tesla-new-feature.png' height="600">        
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
### The real world is still tough, though        
https://www.linkedin.com/feed/update/urn:li:activity:6726521616223784960/
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
### 1st central question 
## Motivation: Business benefit 

</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Make sure you optimize for something reasonable 

<img src='img/tennis-ball-loss.png'>

<small>https://twitter.com/abhisheksh_98/status/1323556208020660225</small>
</textarea>
</section>


<section data-markdown>
    <textarea data-template>
### Kinds Business benefit 

1. improvement
   - which goal should be achieved or - more concretely - which business metric should be improved 
   - E.g. "Increase share of young customers", "Reduce processing time per transaction", "Which product would my customers still want?
2. Complete innovation
   - what can people not do so far?

</textarea>
</section>


<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### Develop business processes through machine learning
## Rationalization (incremental)
_People master this activity in sufficient quality_
* so far not worthwhile, because of high human effort
* Machine Learning can do it not necessarily better, but good enough and efficient
* Examples
    * automatic detection of problematic tweets on Twitter
    * Route planning 
    * Impact of marketing in just about every company
    </textarea>
</section>

<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### Develop business processes through machine learning
## Innovation, paradigm shift (groundbreaking)
_humans cannot do this well enough_
* learning machines can do this sufficiently well
* less often and more difficult to find and implement, but then groundbreaking
* Examples
    * which page people really want to see and which advertisement fits here at Google
    * Recommend content to Netflix or Spotify based on what you've heard or seen
    </textarea>
</section>

<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### Hands-On: Identify candidates for applications

_Describe 3-4 possible applications_

1. Describe the idea without using the words ML or AI
1. do not think about feasibility, yet

Only describe
1. idea
1. business benefit
1. is the idea groundbreaking or incremental?
1. type of data (if already have an idea)
        
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Teams

<div style="font-size: large;">

* <a data-ex='ex-applications-1'>Team 1</a>: <span data-ex='ex-applications-1'>broken</span>
* <a data-ex='ex-applications-2'>Team 2</a>: <span data-ex='ex-applications-2'>broken</span>
* <a data-ex='ex-applications-3'>Team 3</a>: <span data-ex='ex-applications-3'>broken</span>
* <a data-ex='ex-applications-4'>Team 4</a>: <span data-ex='ex-applications-4'>broken</span>

</div>
Copy-Paste all elements
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
# Questions?

    </textarea>
</section>

<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### 2nd central question 
## What data is there? 

- Is there any data at all? 
- Is there data in sufficient quantity?
- Estimation: Do the data cover all cases?
    - Less than 30 records per category are considered "small" in the statistics in any case
    - Usually you need much more data sets
    - Crucial: What is the quality and variance of the data?
    - With image data, you typically need tens of thousands of examples, or better significantly more
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### ML Models are restricted by their training data

<img src='img/ml-view-on-data.png' height="350px">

<small>

https://twitter.com/jacobmenick/status/1260658763687538688
</small>
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Data determines what kind of learning strategy is applicable 

There are different Learning Strategies

</textarea>
</section>

<section data-markdown class="fragments">
    <textarea data-template>
### Bert QNA

_Supervised Learning_

<img src='img/bert-sample.png' height="400">

<small>

https://storage.googleapis.com/tfjs-models/demos/mobilebert-qna/index.html
</small>

</textarea>
</section>

<section data-markdown class="fragments">
    <textarea data-template>
### Bert QNA

_Stanford Question Answering Dataset_

SQuAD2.0 combines the 100,000 questions in SQuAD1.1 with over 50,000 unanswerable questions written adversarially
    by crowdworkers to look similar to answerable ones. To do well on SQuAD2.0, systems must not only answer questions
    when possible, but also determine when no answer is supported by the paragraph and abstain from answering.

<small>

https://rajpurkar.github.io/SQuAD-explorer/
https://github.com/tensorflow/tfjs-models/tree/master/qna
https://github.com/google-research/bert#what-is-bert

</small>

</textarea>
</section>


<section data-markdown class="fragments">
    <textarea data-template>
### Supervised Learning 

* The system has learned from matching pairs of question and answer 
* It can then implement our specifications in a generalized manner
</textarea>
</section>

<section data-markdown class="fragments">
<textarea data-template>
### When to apply Supervised Learning

_classify categories or predict values_

* you have matching pairs of input and output and want the model to generate output for unknown input
* the solution to the problem at hand is unknown or hard to specify
* solving the problem can tolerate some error or uncertainty
* there is a clear, simple input and output

_what we see applied most of the time_
</textarea>
</section>

<section data-markdown id='rl'>
    <textarea data-template>
## Unsupervised Learning

</textarea>
</section>

<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### Detecting Anomalies in electrocardiograms 

* Train autoencoder with (mostly) normal data to low reconstruction loss
* Abnormal data (not used for training) will not be reproduced well, i.e. will have high reconstruction loss
* Set a threshold on loss by maximizing a metric (accuracy)
* Can do without any labelling
* Does not need abnormal data for training (but can tolerate some abnormal data)

<img src='img/ecg.png'>


</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Outlier Detection: Anomagram 

_Unsupervised Learning_

<a href='https://victordibia.github.io/anomagram/#/'>
<img src='img/anomagram-inference.gif' height="400">
</a>
<small>

https://github.com/victordibia/anomagram        
</small>
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Shared Exercise: Clusters and Outliers

<div style="display: flex;">
    <div style="flex: 50%;">
        <img src='img/unsupervised/clustering.jpg'>
    </div>
    <div style="flex: 50%; font-size: x-large;">

1. Mark all clusters
1. Mark all data points that do not belong to a cluster

Discuss
1. In which way is this very different from our first example?
1. Do you see clusters that look suspicious?
1. What could be on the axes? Is this important for recognizing clusters?
1. What could a cluster mean?
1. How could you interpret data points do not belong to a cluster?

</div>
</div>
</textarea>
</section>

<section data-markdown class="fragments">
    <textarea data-template>
### When to apply Unsupervised Learning

_cluster, find similarities or outliers_

* you have sample data but no labels
* clusters and outliers must be clearly separable

e.g.
* Fraud Detection
* Similarities in customers / partners
* Anomaly Detection

_often in addition or a first step to supervised learning_

</textarea>
</section>

<section data-markdown id='rl'>
    <textarea data-template>
## Reinforcement Learning

</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Finding the optimal route

<img src='img/rl/turf.png' height="450px">
    
    
<small>
the bear has to collect all the honey along the paths and return to where he started, how much will it cost the animal?
</small>
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Programmatic solution

* search on graphs
* can find optimal solutions (or at least good ones)
* but only on small problems
* exponential complexity
        </textarea>
        </section>

        <section data-markdown>
                <textarea data-template>
### Alternative: Machine Learning

Can we exchange?
* _exponential time_ for _linear time_
* _perfect path_ for _near-optimal path_ 
* _always works for small problems_ for _often works for all sizes of problem_ 

                    </textarea>
                </section>

<section data-markdown class="fragments">
<textarea data-template>
### But we have no training data

* It is possible to gain training data through experiments
* You will need a simulated world to run the experiments in, though
* Experiments are guided by saying which results are good and which are bad
* _This is called Reinforcement Learning_

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Reinforcement Learning in Production

<img src='img/rl/rl-train-play-1.png' height="550">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Reinforcement Learning in Development

<img src='img/rl/rl-train-play-2.png' height="550">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Training a Model using Reinforcement Learning 

<video controls src="img/rl/training.mp4"  muted type="video/mp4" height="450"></video>

<small style="font-size: large;">https://colab.research.google.com/github/christianhidber/easyagents/blob/master/jupyter_notebooks/workshop/orso.ipynb?hl=en</small>

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Solution
<video controls src="img/rl/orso-sample-path.mp4"  muted type="video/mp4" height="500"></video>
        
</textarea>
</section>


<section data-markdown class="fragments" style="font-size: xx-large">
    <textarea data-template>
### Structure of Observation and Reward are crucial

agents can learn short cuts and unexpected behavior

1. Robot hand pretending to grasp an object by moving between the camera and the object
1. Agent pauses the game indefinitely to avoid losing
1. Agent kills itself at the end of level 1 to avoid losing in level 2

<small>

https://twitter.com/mogwai_poet/status/1060286856493813760    
</small>
    
    </textarea>
    </section>
        
<section data-markdown>
<textarea data-template>
### When to apply Reinforcement Learning

* If you have no training data Reinforcement Learning might be an option
* You will need a simulator for your problem, though 
* Agent will learn by being rewarded in a simulated world
* Modelling that simulated world might be the hardest part of the job
* serious applications include operations research, robotics, planning, and configuration 
</textarea>
</section>


<section data-markdown style="font-size: xx-large;">
    <textarea data-template>

### Once again for comparison 
* Ask questions to texts
   * _Supervised Learning_
   * Predict sequence of categories (words)
   * Neural network with TensorFlow
* Detect anomalies in heartbeats
  * _Unsupervised Learning_
  * Predict Boolean category
  * Autoencoder (neural network) with TensorFlow
* Playing chess
  * _Reinforcement Learning_ / Monte Carlo Tree Search
  * Predict category (train)
  * Policy (Neural Network) with TensorFlow
</textarea>
</section>


<section data-markdown>
    <textarea data-template>
### Shared Exercise: Which Learning Strategy?    

<div style="display: flex;">
    <div style="flex: 50%;">
        <img src='img/ML-strategy-helper.png'>
    </div>
    <div style="flex: 50%; font-size: x-large;">

1. Detecting tuberculosis from X-Rays 
1. Teaching a robot to pick up objects
1. Finding a good set of hyperparameters in deep learning
1. Optimal pricing for flight tickets
1. Deciding risk class of potential customers for insurance
1. Learn how to control traffic lights
1. Detecting credit card fraud 
1. Which football players are similar?
1. News Recommendation
1. Predicting when a machine needs maintenance

</div>
</div>
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### 3nd central question 
## What are the important properties 

</textarea>
</section>

<section data-markdown>
    <textarea data-template>
"In einer Kategorie schnitten die deutschen Hersteller jedoch besonders schlecht ab. So schaffen es deren Fahrassistenten offenbar nicht, dem Fahrer klarzumachen, wann er besser auf sie verzichten sollte. In dieser Disziplin erreichten die getesteten Systeme von Audi, BMW, Mercedes-Benz, Porsche und VW nur zwei von zehn Punkten."

<small>https://www.spiegel.de/auto/tesla-autopilot-verliert-in-test-von-consumer-reports-gegen-konkurrenten-a-0b3666f4-20b1-4fea-87f0-319e899bc355</small>

</textarea>
</section>

<section data-markdown class="fragments" style="font-size: xx-large;">
<textarea data-template>

### Accuracy is king for applications of Machine Learning

* applications have vastly different requirements on adequate accuracy (AA)
* 60% or 70% of accuracy are not good or bad values or by themselves
* only very few with more than 85% accuracy at http://scaledml.org/2020/

Recommendation
* either find out what you can do with a given AA 
* or see if there is a way to get to the AA you need for a specific application
</textarea>
</section>

<section data-markdown class="fragments">
<textarea data-template>
### Be clear about which level of explainability you need

* probably has an impact on what kind of ML you can use (or no ML at all)
* Neural Networks typically are black boxes, but very powerful
* Decision Trees (especially when shallow) can be understood, but are often not as powerful
* This might turn out to be a compromise between adequate accuracy and explainability
</textarea>
</section>

<section data-markdown class="fragments">
    <textarea data-template>
### Poll: What do you prefer?

1. a human doctor, who is 80% correct with his diagnosis and can explain to you how he comes up with it or 
1. an ML doctor, who is 95% correct, but cannot explain anything because of superhuman thought processes

    </textarea>
</section>

<section data-markdown class="fragments">
<textarea data-template>
### Performance

* latency and throughput
   * both for training and prediction
* will you need a GPU?   
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### the tool is mostly irrelevant, much more important are data and conceptual considerations         
</textarea>
</section>

<section data-markdown class="fragments">
    <textarea data-template>
#### Level of flexibility needed

<img src='img/abstractness.png'>
</textarea>
</section>
    
<section data-markdown>
    <textarea data-template>
### Kind of Prediction

<img src='img/kind-of-prediction.png'>

</textarea>
</section>

<section data-markdown style="font-size: xx-large;">
    <textarea data-template>
### Hands-On: Concretizing applications

_sort your possible applications by subjective attractiveness, for the most promising ones add_
1. the learning strategy
1. kind of prediction
1. relevant properties (describe in more detail)
1. estimated implementation effort
1. type of data (if done yet or changed because of new insights)

 _prepare to present the most attractive application_
        
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Presentation and discussion of most attractive application per team

    </textarea>
</section>

<section data-markdown>
<textarea data-template>
### ML is research and a bit of engineering rather than a craft
<img src='img/ml_is_not_programming.jpg' height="400px">

*Machine Learning = Lab Work*

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Styropor had been invented accidentally

you want coating for cables and get a new synthetic material 

<img src='img/erdal.jpg' height="420">


<small>

https://airpop.de/home/die-geschichte    
</small>
</textarea>
</section>

<section data-markdown style="font-size: xx-large;">
<textarea data-template>
### Procedure in a machine learning project

- this resembles less a software development process than a research project
- the chosen approach may therefore not be target-oriented or Machine Learning may not be applicable at all
- whether the approach is suitable should be found out as quickly as possible
- Procedure is similar to an agile process
- determine in short iterations as quickly as possible whether a further procedure makes sense and if so, what it should look like
- a first stress test of the idea is possible as a thought experiment or game
</textarea>
</section>

<section data-markdown>
<textarea data-template>
# Appendix
## Assorted Case Studies

</textarea>
</section>


<section data-markdown>
<textarea data-template>
## Application #1
### Deep Supervised Machine Learning: Forecasting time series using RNNs

<small>

https://colab.research.google.com/github/DJCordhose/ml-workshop/blob/master/notebooks/tf2/time-series-rnn-full-predict.ipynb    

</small>
</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Germany's Consumption of Energy over time

<img src='img/tsa/consumption-overview.png' height="450">

_Could we do a reasonable forecast?_
</textarea>
</section>


<section data-markdown>
<textarea data-template>
### A baseline - rolling mean over the previous 30 days

<img src='img/tsa/baseline-rolling-mean.png' height="450">

<small>
R2 around 0.2    
</small>
</textarea>
</section>


<!-- <section data-markdown>
<textarea data-template>
### Statistical Decomposition of Consumption

<img src='img/tsa/tsa-decomposition.png' height="450">

</textarea>
</section>
-->
<section data-markdown>
<textarea data-template>
### R2 Metric: a speaking metric for regression

* R^2 score, the closer to 1 the better
* loosely speaking: how much better is this than predicting the constant mean
* 0 would mean just as good
* 1 is perfect
* neg. would mean even worse
* it can become arbitrarily worse

https://en.wikipedia.org/wiki/Coefficient_of_determination
</textarea>
</section>

<section data-markdown>
<textarea data-template>
### RNNs - Networks with Loops

<img src='img/colah/RNN-rolled.png' height="450px">

<small>

http://colah.github.io/posts/2015-08-Understanding-LSTMs/
</small>
</textarea>
</section>

<!-- <section data-markdown>
<textarea data-template>
### Unrolling the loop

<img src='img/colah/RNN-unrolled.png'>

<small>

http://colah.github.io/posts/2015-08-Understanding-LSTMs/
</small>
</textarea>
</section> -->

<section data-markdown>
<textarea data-template>
### Results on Test data`

<img src='img/tsa/test-eval.png' height="450">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
#### Before you get tempted, read this

<img src='img/fchollet-stock-prices.png'>
<small>

https://twitter.com/fchollet/status/1177633367472259072
</small>
    </textarea>
</section>

<section data-markdown>
<textarea data-template>
### Observations

* r2 score over 0.8 is pretty promising
* definitely improved over baseline
* no domain knowledge necessary
* peaks and valleys are underestimated very often
* but often the most interesting part
* common problem in time series prediction
</textarea>
</section>

<section data-markdown>
<textarea data-template>
## Lessons Learned

* Neural Networks are a different style of machine learning
* Recurrent Neural Networks can learn from sequences of data
* Neural Networks are very powerful and might outperform hand written heuristics
</textarea>
</section>

<section data-markdown>
<textarea data-template>

## Application #2: Traffic Sign Recognition
### Classifying Images using CNNs

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Problem: What speed limit?

<img src='img/speed-limit-signs.png'>

<small>

https://colab.research.google.com/github/DJCordhose/ml-workshop/blob/master/notebooks/tf2/images-intro.ipynb
</small>
</textarea>
</section>    

<!-- <section data-markdown>
<textarea data-template>
### Challenges for Images Recognition

1. Feeding all pixels into Dense Layers will work, but slow and many parameters 
1. Manual Feature extraction from images might work, but
* is tedious and error prone
* requires domain knowledge
* needs frequent manual updates
1. Convolutional networks will learn feature extraction before passing few features to Dense Layer Classifiers

<small>

https://towardsdatascience.com/simple-introduction-to-convolutional-neural-networks-cdf8d3077bac
</small>
</textarea>
</section> -->

<section>
<h3>Architectures of Convolutional Neural Networks: VGG</h3>
<img src="img/vgg.png" height="350px">
<p>
    <small>There are a number of specialized neural network layers</small>
</p>
</section>

<section>
    <h3>MNIST - Using a model <em>already trained</em></h3>
    <p>Exploring the different types layers together</p>
    <a href="https://transcranial.github.io/keras-js/#/mnist-cnn" target="_blank">
        <img src="img/keras-browser.png" height="350px">
    </a>
    <p><small>
        <a href="https://transcranial.github.io/keras-js/#/mnist-cnn" target="_blank">https://transcranial.github.io/keras-js/#/mnist-cnn</a>
    </small></p>
</section>

<section data-markdown>
<textarea data-template>
### Results: Samples

<img src='img/signs/signs-eval.png' height="550">
    </textarea>
</section>

<section data-markdown>
<textarea data-template>
### Results: Incorrect

<img src='img/signs/signs-incorrect.png' height="550">
    </textarea>
</section>

<section data-markdown>
<textarea data-template>
### Results: Most Certain and Correct

<img src='img/signs/signs-certain-correct.png' height="550">
    </textarea>
</section>

<section data-markdown>
<textarea data-template>
### Results: Most Uncertain, but Correct

<img src='img/signs/signs-uncertain-correct.png' height="550">
    </textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Application #3

### Deep Unsupervised Learning: Finding similar airlines and outliers`
</textarea>
</section>

<section data-markdown>
<textarea data-template>
#### Which airlines are similar, which are exceptions?

<img src='img/embeddings/airline-embedded-cluster.png' height="550px">

</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Approach

* First dimension: number of passengers
* Second dimension: similarity by typical route
* Cluster airlines

        </textarea>
    </section>

<section data-markdown>
    <textarea data-template>
## First Challenge

### How to automatically cluster?

        </textarea>
    </section>

<section data-markdown id='unsupervised-2'>
    <textarea data-template>
### DBSCAN

<img src="img/unsupervised/800px-DBSCAN-Illustration.svg.png" height="450px">

<small>

Density-Based Spatial Clustering: 
https://en.wikipedia.org/wiki/DBSCAN
</small>
        </textarea>
    </section>
    
    <section data-markdown>
        <textarea data-template>
### Demo Cluster
<img src="img/unsupervised/dbscan-demo.png" height="550px">


</textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Second Challenge

### How do you describe similarity in a single dimension?

        </textarea>
    </section>

<section data-markdown>
    <textarea data-template>

<img src='img/embeddings/embedding_5.png'>

        </textarea>
    </section>
<section data-markdown>
<textarea data-template>
### Resulting Plot of Airline Embedding 

<img src='img/embeddings/2d_embedding_airlines.png' class='with-border' style="float: left" height="350px">
<img src='img/embeddings/1d_embedding_airlines.png' class='with-border' style="float: right" height="350px">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Result: Clustering using 1d embedding

<img src='img/embeddings/airline-embedded-cluster.png' height="550px">

</textarea>
</section>

<!-- <section data-markdown>
    <textarea data-template>
## Lessons Learned

* embeddings can be extremely useful and efficient representations
* you can turn categories, symbols, words into numbers of any dimension
* you can do this by training a neural network
* if successful results will preserve semantics
* main factor of success is a dataset that contains semantic information
* the lines between classic programming and machine learning are already blurred here
</textarea>
</section> -->
<!-- 
<section data-markdown>
<textarea data-template>
## Application #4

### Deep Reinforcement Learning: graph data for route planning
</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Find the optimal route

<img src='img/rl/turf.png' height="450px">

<small>

https://opendatascience.com/bears-need-to-learn-as-well-practical-reinforcement-learning-with-tensorflow-2-0-tf-agents/

</small>
</textarea>
</section>

<section data-markdown>
<textarea data-template>
## Programmatic solution

* best-first search
* will find optimal solution
* but only on small problem
* exponential complexity
    </textarea>
    </section>

    <section data-markdown>
            <textarea data-template>
### Alternative: Machine Learning

Swapping
* exponential time for linear time
* perfect path for near-optimal path 

                </textarea>
            </section>

<section data-markdown>
<textarea data-template>
### But we have no training data

* It is possible to gain training data through experiments
* You will need a simulated world to run the experiments in, though
* Experiments are guided by saying which results are good and which are bad

_This is called Reinforcement Learning_

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Reinforcement Learning: Using an Agent

<img src='img/rl/rl-train-play-1.png' height="550">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Reinforcement Learning: Training an agent

<img src='img/rl/rl-train-play-2.png' height="550">

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Solution
<video controls src="img/rl/orso-sample-path.mp4"  muted type="video/mp4" height="500"></video>
        
</textarea>
</section> -->


<!-- <section data-markdown>
<textarea data-template>
### Learning in a simulated world
<video controls src="video/knocked-over-stand-up.mp4"  muted type="video/mp4" height="500"></video>
        
<small>
https://blog.openai.com/openai-baselines-ppo/
</small>
</textarea>
</section> -->

<!-- <section data-markdown>
<textarea data-template>
### OpenAI Platforms

<img src='img/rl/openai.jpg' height="500px">

<small>
https://openai.com/systems/
</small>
</textarea>
</section> -->

<!-- <section data-markdown>
<textarea data-template>
### Modelling our world
<pre><code contenteditable data-trim class="fragment line-numbers python">
# what can the agent do?

self.map = {
'S': [('A', 300), ('B', 100), ('C', 200 )],
'A': [('S', 300), ('B', 100), ('E', 100 ), ('D', 100 )],
'B': [('S', 100), ('A', 100), ('C', 50 ), ('K', 200 )],
'C': [('S', 200), ('B', 50), ('M', 100 ), ('L', 200 )],
'D': [('A', 100), ('F', 50)],
...
}
max_paths = 4
self.action_space = spaces.Discrete(max_paths)
</code></pre>


<pre><code contenteditable data-trim class="fragment line-numbers python">
# what does the agent see?

# observations: position, reward of all 4 local paths, 
# rest reward of all locations
low = # pos0, -1000 reward for missing path, 0 for rest rewards
high = # last pos, 1000 max reward, 1000 for rest rewards
self.observation_space = spaces.Box(low=low, high=high)

</code></pre>

<small>
https://colab.research.google.com/github/DJCordhose/ai/blob/master/notebooks/rl/berater-v11.ipynb
</small>

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Rewards while training

<img src='img/rl/berater/v11-learning-curve.png'>

Average Reward at end of training: ~ .73 (optimum .73 - .74)
<br>
Average length of path: ~ 15

<small>
https://colab.research.google.com/github/DJCordhose/ai/blob/master/notebooks/rl/berater-v11.ipynb
</small>
    </textarea>
</section> -->

<!-- <section data-markdown>
        <textarea data-template>
### Alternative Solution

* OracleNet uses Recurrent Neural Networks
* generating near-optimal paths in a single, iterative, end-to-end roll-out
* generally has fixed-time execution regardless of the configuration space complexity while 
* outperforming popular pathfinding algorithms in complex environments and higher dimensions

<small>
https://arxiv.org/abs/1904.11102
</small>
</textarea>
</section> -->


</div>
</div>

<script src="reveal.js/js/reveal.js"></script>
<script src="lib/jquery-2.2.4.js"></script>

<script>
        // $('section:not([data-background])').attr('data-background', "background/white.jpg");
        // $('section:not([data-background])').attr('data-background', "background/sky.jpg");
        // $('section:not([data-background])').attr('data-background', "background/magnolia.jpg");
        // $('section:not([data-background])').attr('data-background', "background/pale-clouds.jpg");
        // $('section:not([data-background])').attr('data-background', "background/street.jpg");
        // $('section:not([data-background])').attr('data-background', "background/white-transparent.jpg");
    </script>
    <script>
        const isLocal = window.location.hostname.indexOf('localhost') !== -1 || 
                    window.location.hostname.indexOf('127.0.0.1') !== -1;

        $('.hide').remove();

        if (isLocal && !printMode) {
        } else {
            // only applies to public version
                $('.todo').remove();
                $('.preparation').remove();
                $('.local').remove();
        }
    
        Reveal.addEventListener( 'ready', function( event ) {
            // applies to all versions
            $('code').addClass('line-numbers');
    
            $('.fragments li').addClass('fragment')
    
            // make all links open in new tab
            $('a').attr('target', '_blank')
    
            if (isLocal && !printMode) {
                // only applies to presentation version
                Reveal.configure({ controls: false });
            } else {
                // only applies to public version
                $('.fragment').removeClass('fragment');
            }
            setMuralLinks();
    
        } );

        function setMuralLinks() {
            // Master: https://app.mural.co/t/embarcagila3904/r/1604142232228
            // Copy: https://app.mural.co/t/workshop8572/r/1604826183354

            const mural_apps_1 = `https://app.mural.co/t/workshop8572/m/workshop8572/1604826183397/377f12d799f0e4bf80c75d3e63b547cd683117f4`
            const mural_apps_2 = `https://app.mural.co/t/workshop8572/m/workshop8572/1604826183400/7325670a605d1924de5853c68d6ae1aa0a818dd3`
            const mural_apps_3 = `https://app.mural.co/t/workshop8572/m/workshop8572/1604826183403/250f895f1b670130af35b497f4ba1673ac305132`
            const mural_apps_4 = `https://app.mural.co/t/workshop8572/m/workshop8572/1604826183405/2988cbbb9019426f61771ab2936c3356a876a43c`

            fillExercise('ex-applications-1', mural_apps_1);
            fillExercise('ex-applications-2', mural_apps_2);
            fillExercise('ex-applications-3', mural_apps_3);
            fillExercise('ex-applications-4', mural_apps_4);
        }

        function fillExercise(id, mural) {
            document.querySelectorAll(`a[data-ex="${id}"]`).forEach(el => el.href = mural)
            document.querySelectorAll(`:not(a)[data-ex="${id}"]`).forEach(el => el.innerText = mural)
        }
    </script>
    
<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        width: 1100,
        slideNumber: true,

        transition: 'fade', // none/fade/slide/convex/concave/zoom

        math: {
             mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
            config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
        },

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'reveal.js/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'reveal.js/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'reveal.js/plugin/zoom-js/zoom.js', async: true},
            {src: 'reveal.js/plugin/notes/notes.js', async: true},
            // https://github.com/mikemiles86/reveal-line-numbers
            {src: 'lib/js/line-numbers.js'},
            { src: 'reveal.js/plugin/math/math.js', async: true }

        ]
    });

</script>

</body>
</html>
