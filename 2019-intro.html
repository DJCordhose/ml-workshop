<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Intro</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

          <link rel="stylesheet" href="reveal.js/css/reveal.css">
          <!--<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">-->
          <!--<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">-->
          <link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
      
          <!-- Code syntax highlighting -->
          <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
          <style>
              /*pre code {*/
                  /*display: block;*/
                  /*padding: 0.5em;*/
                  /*background: #FFFFFF !important;*/
                  /*color: #000000 !important;*/
              /*}*/
      
              .right-img {
                  margin-left: 10px !important;
                  float: right;
                  height: 500px;
              }
              .todo:before {
                  content: 'TODO: ';
              }
              .todo {
                  color: red !important;
              }
              code span.line-number {
                  color: lightcoral;
              }
              .reveal pre code {
                  max-height: 1000px !important;
              }
      
              img {
                  border: 0 !important;
                  box-shadow:0 0 0 0 !important;
              }
      
              .reveal {
                  -ms-touch-action: auto !important;
                  touch-action: auto !important;
                      }
      
                      .reveal h2,
                      .reveal h3,
                      .reveal h4 {
                        letter-spacing: 2px;
                        font-family: 'Calibri', sans-serif;
                          /* font-family: 'Times New Roman', Times, serif; */
                          font-weight: bold;
                          color: black;
                          font-style: italic;
                          letter-spacing: -2px;
                          text-transform: none !important;
                      }
      
                      .reveal em {
                          font-weight: bold;
                      }
      
                      .reveal .step-subtitle h1 {
                          letter-spacing: 1px;
                      }
                      .reveal .step-subtitle h2,
                      .reveal .step-subtitle h3 {
                          text-transform: none;
                          font-style: italic;
                          font-weight: normal;
                          /* font-weight: 400; */
                          /* font-family: 'Amiri', serif; */
                          font-family: 'Lobster', serif;
                          letter-spacing: 1px;
                          color: #2aa198;
                          text-decoration: underline;
                      }
      
                      .reveal .front-page h1,
                      .reveal .front-page h2 {
                          font-family: "League Gothic";
                          font-style: normal;
                          text-transform: uppercase !important;
                          letter-spacing: 1px;
                      }
      
                      .reveal .front-page h1 {
                          font-size: 2.5em !important;
                      }
      
                      .reveal .highlight {
                          background-color: #D3337B;
                          color: white;
                      }
      
              .reveal section img {
                background: none;
              }
      
                      .reveal img.with-border {
                          border: 1px solid #586e75 !important;
                          box-shadow: 3px 3px 1px rgba(0, 0, 0, 0.15) !important;
                      }
      
                      .reveal li {
                          margin-bottom: 8px;
                      }
      
                      /* For li's that use FontAwesome icons as bullet-point */
                  .reveal ul.fa-ul li {
                      list-style-type: none;
                  }

            .reveal {
                color: black !important;
             }       

          </style>
      
    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        var printMode = window.location.search.match(/print-pdf/gi);
        link.href = printMode ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">
    <div class="slides">

<!-- JFokus Talk

3 hours

https://www.jfokus.se/jfokus19/talks/2634

Hands-on-lab: Grundlagen von Machine Learning

In dieser Hands-On-Session bekommst du eine Einführung in die Grundlagen von Machine Learning. Wir machen dabei Experimente auf 
Papier und erste Erfahrungen mit der Python-Bibliothek Scikit-learn. Du brauchst aber weder Erfahrung in Machine Learning, noch
in Python oder Scikit-learn. Du brauchst lediglich ein Laptop auf dem der Chrome Browser installiert ist. 

 -->

 <!-- <section data-markdown class="variations">
        <textarea data-template>
* NVE Workshop
* ML Summit            
    </textarea>
    </section>
     -->
 <section data-markdown class="preparation">
    <textarea data-template>
### Preparation Workshop

* `exercise/2019-workshop-exercises.docx` ausdrucken für alle Teilnehmer
</textarea>
</section>


<!-- <section data-markdown style="font-size: xx-large">
        <textarea data-template>
## Hands-on-lab: Machine Learning for Software Developers

If you are bored
1. #wifi Name: XXX, pwd: XXX
1. Open this slide deck: http://bit.ly/ml-jfokus-hands-on
1. Make sure you are ready to work with Colab
   * open https://colab.research.google.com/github/djcordhose/ai/blob/master/notebooks/sklearn/dt-intro.ipynb in Chrome
   * make it run using the "Run All" command from the "Runtime" menu
   * save the notebook in your Drive
    
    </textarea>
    </section> -->
    
            <!-- <section>
            <br>
            <br>
            <h2>Grundlagen von Machine Learning</h2>
            <br>
            <br>
            <p><a target="_blank" href="xxx">
                ML Summit, Berlin, October 2019
            </a></p>
            <h4><a href="http://zeigermann.eu">Oliver Zeigermann</a> / 
                <a href="http://twitter.com/djcordhose">@DJCordhose</a>
            </h4>
            <p><small><a href="http://bit.ly/xxx">
                    http://bit.ly/xxxx
            </a></small></p>
        </section> -->

    <!-- <section data-markdown class="todo">
        <textarea data-template>
    </textarea>
    </section> -->

    <section data-markdown>
        <textarea data-template>
## Introduction: Supervised Learning with Scikit-learn
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
<!-- ### ML rather is research and a bit of engineering than a craft -->
### Machine Learning = Lab Work
<img src='img/ml_is_not_programming.jpg' height="450px">
</textarea>
</section>


    <section data-markdown>
        <textarea data-template>
### Objectives

* What is the basic idea of data driven machine learning?
* Challenges of data preparation and cleaning
* First steps with Scikit-learn
* Generalization: Why and how?
        </textarea>
    </section>

    <section data-markdown>
        <textarea data-template>
### Our Scenario for today

* We are CTO of a highly innovative Car Insurance Company
* Different from other insurance companies we determine the rate by the actual number of accidents per customer
* _Objective: how many accidents will prospective customers have?_ 
 
<img src='img/pixabay/accident-151668_1280.png' height="300px">
        </textarea>
    </section>

<section data-markdown>
        <textarea data-template>
### Three Inputs for Prediction

<a href='html/calculator.html'>
<img src='img/insurance/calculator.png' height="450">
</a>
<p><small>
    <a href='html/calculator.html' target="_blank">
        https://djcordhose.github.io/ai/html/calculator.html</a></small>
</small></p>
</textarea>
    </section>

            <section data-markdown>
                    <textarea data-template>
## How to solve this programmatically?
                        </textarea>
                        </section>
            
            <section data-markdown>
                    <textarea data-template>
                    <img src='img/classic-development.jpg'>
                    </textarea>
                    </section>
                    
                    <section data-markdown>
                        <textarea data-template>
    ### Exploration
    <img src='img/insurance/sns-pairplot.png' height="550px">
                
                    </textarea>
                    </section>
    <section>
        <h3>Programmer's approach: Code Rules by Hand</h3>
        <div class="fragment">
        <pre><code contenteditable data-trim class="line-numbers python">
if age < 25:
    if speed > 140:
        return red # young people, fast cars: high risk
    else:
        return yellow # young people: medium risk
            </code></pre>
        </div>
        <div class="fragment">
        <pre><code contenteditable data-trim class="line-numbers python">
if age > 75:
    return red # old people: high risk
            </code></pre>
        </div>
        <div class="fragment">
        <pre><code contenteditable data-trim class="line-numbers python">
if miles_per_year > 30:
    return red # a lot of driving: high risk
if miles_per_year > 20:
    return yellow #  a bit of driving: medium risk
            </code></pre>
        </div>
        <div class="fragment">
        <pre><code contenteditable data-trim class="line-numbers python">
return green # otherwise: low risk
            </code></pre>
        </div>
<p><small>
    <a href='https://colab.research.google.com/github/djcordhose/ai/blob/master/notebooks/sklearn/classic-code.ipynb>'>https://colab.research.google.com/github/djcordhose/ai/blob/master/notebooks/sklearn/classic-code.ipynb</a>
</small></p>
    </section>

<section data-markdown>
    <textarea data-template>
### How good is this?

<!-- <p class="fragment"><em>How well have we mastered the domain?</em></p> -->

* Is it better than guessing?
* Are all the rules correct?
* Are some missing?
* How would we even know?

</textarea>
</section>                    

<section>
<h3>Different Approach</h3>

<div style="max-width: 50%; float: left;">
    <img src='img/insurance/df_head.jpg' height="450">
</div>
<div style="max-width: 50%; float: right;">

    <br>
    <br>
    <br>
    <ul>
        <li>0 - red: many accidents</li>
        <li>1 - green: few or no accidents</li>
        <li>2 - yellow: in the middle</li>
    </ul>
    </div>
    
    
<p style="clear: both;">
    <em>
Looking at the problem from the perspective of our data
</em>
</p>
        </section>

<section>
    <h3>Let's check: Is the data we have any good?</h3>
    <img src="img/insurance/all.png" height="500px" class="fragment">
    <small  class="fragment">Would we able to rank me (47) for a car having 100 mph top speed, driving 10k miles per year?</small>
</section>

<section data-markdown class="workshop">
    <textarea data-template>
### Would we be able to separate different classes by drawing a few lines?

    </textarea>
        </section>


<section data-markdown class="workshop exercise">
    <textarea data-template>
### Paper Exercise #1 - Understanding the Supervised Learning Approach

_team up and discuss with your neighbors_

* Manually cluster areas of different customer types on the <em>upper part</em> of the handout
* Be sure to use a ballpen and apply pressure when drawing

<a href='/exercise/2019-workshop-exercise.pdf'>Exercise as PDF</a>
    </textarea>
        </section>

<section data-markdown class="workshop">
<textarea data-template>
### Two Sample Solutions

<img src='img/decision-boundaries/decision-boundaries-train.jpg'>
<small>
Are they the same? What is the key difference?
</small>
</textarea>
</section>

        
        <!-- <section class="workshop">
    <h3>Manual Classification - red</h3>
    <img src="img/decision-boundaries/decision-boundaries-1.jpg">
</section>

<section class="workshop">
    <h3>Manual Classification - yellow</h3>
<img src="img/decision-boundaries/decision-boundaries-2.jpg">
</section>

<section class="workshop">
    <h3>Manual Classification - green</h3>
<img src="img/decision-boundaries/decision-boundaries-3.jpg">
</section> -->

<section class="workshop">
    <h3>Decision Bounaries</h3>
<img src="img/decision-boundaries/decision-boundaries-4.jpg">
</section>

<section data-markdown class="workshop">
<textarea data-template>
## Core Question

### Can we automate this process of drawing Decision Bondaries?
</textarea>
</section>


<section data-markdown>
<textarea data-template>
<img src='img/supervised-ml.jpg' height="650px">
</textarea>
</section>

<section data-markdown class="workshop">
    <textarea data-template>
### Step I
## Data Preparation
</textarea>
</section>

<section data-markdown class="workshop">
        <textarea data-template>
### Data is King

_collecting data might be the hardest part of the job_

* but also the most important
* no data, not good quality or quantity => no supervised machine learning
* if we have a simulator, reinforcement learning might be an option
    
    </textarea>
    </section>
    
    <section data-markdown>
        <textarea data-template>
### Data and Process are king                    

<img src='img/googleml/model-architecture-not-important.jpg'>

<small>

https://developers.google.com/machine-learning/guides/rules-of-ml/    
</small>                    
        </textarea>
    </section>



<section data-markdown class="workshop">
    <textarea data-template>
### Clean Data and Select Features

<img src='img/insurance/data.png' height="500">

</textarea>
</section>

<section data-markdown class="workshop exercise">
    <textarea data-template>
### Exercise on Paper #2 - Data Cleaning and Feature Selection

_Data Cleaning_
* What errors do you find in the data? Mark on paper and describe
* How to deal with those errors?

_Feature Selection_
* Which column would you predict?
* Which columns would you use as input for training?
* Would you use all columns? If not, why?

<!--
- Datendopplung Zeile 4/5 => eine löschen
- Fehlender Wert Zeile 16 => Zeile löschen oder Durchschnitt
- Spalte 'state' mit mehr als 50% fehlenden Werten
- Zeile 23 Ausreißer: Zeile löschen oder auf plausiblen Wert korrigieren 
- Zeile 24: Califorina
-->


    </textarea>
        </section>


<section data-markdown style="font-size: xx-large" class="workshop">
        <textarea data-template>
### Results: Data Cleaning und Feature Selection

_Data Cleaning_
* Typos: Califorina
* Outliers: Delete line or replace with decent value
* Doubles: Delete
* Missing Value: Delete line or replace with imputed value

_Feature Selection_
* Make sure which value to predict
* Row missig more than 50% of values: do not use
* Explore dependencies to decide what to use for training input
            </textarea>
            </section>

    <section data-markdown class="detail">
    <textarea data-template>
### Final Check on Collected Data

<img src='img/insurance/df_describe.png' height="500">

</textarea>
</section>

<section data-markdown class="workshop">
    <textarea data-template>
### Step II
## Training
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
### Revisiting our Rule based approach

Plotting the predictions as a background

<img src='img/decision-boundaries/5-prog.png' class="fragment" height="450px">
<br>
<small class="fragment">approx. 43% predictions correct</small>
</textarea>
</section>

<section data-markdown>
    <textarea data-template>
## Do we really have to write those rules by hand?
</textarea>
</section>

    <section data-markdown>
            <textarea data-template>
### Decision Trees can learn such rules

<img src="img/dt/dt-all.png" height="500px">
        </textarea>
        </section>
    <section>
<h3>Code in Scikit-learn</h3>

<p>Training</p>
<pre><code contenteditable data-trim class="fragment line-numbers python">
from sklearn.tree import DecisionTreeClassifier
clf = DecisionTreeClassifier()
clf.fit(X_train, y_train)
            </code></pre>
        
<p>Prediction</p>
<pre><code contenteditable data-trim class="fragment line-numbers python">
y_pred = clf.predict(input)
        </code></pre>

<small>
    <a href='https://scikit-learn.org/stable/modules/classes.html'>https://scikit-learn.org/stable/modules/classes.html</a>
    <!-- <br>
    <a href='https://colab.research.google.com/github/djcordhose/ai/blob/master/notebooks/sklearn/overview.ipynb'>
        https://colab.research.google.com/github/djcordhose/ai/blob/master/notebooks/sklearn/overview.ipynb</a> -->
</small>
        </section>
        

    <section data-markdown class="detail">
            <textarea data-template>
### How do they learn?

<img src="img/dt/cart.png" height="500px">

<small>

http://scikit-learn.org/stable/modules/tree.html#tree-algorithms-id3-c4-5-c5-0-and-cart
</small>
        
        
        </textarea>
        </section>

    <section>
            <h3>Decision Trees</h3>
            <div>

        <img src="img/decision-boundaries/dt-sweet-test.png">
        <small>Up to 70% accuracy on unknown data</small>
        </div>
    </section>


    <!-- <section data-markdown>
        <textarea data-template>
### Working with Colab Notebooks

https://colab.research.google.com
        </textarea>
    </section> -->

<section data-markdown>
<textarea data-template>
### Hands-On
_Run your first Colab Notbook_

* Open the notebook containing the training code 
* Sign into your Google account or register a new one 
* Execute cells until the notebook tells you to stop
* Train the model and see how it would classify yourself
* Save your notebook in your Google Drive (or on Github if you want to)

<small>

https://colab.research.google.com/github/djcordhose/ml-workshop/blob/master/notebooks/classic/dt-intro.ipynb
</small>
</textarea>
</section>

<section data-markdown class="workshop">
    <textarea data-template>
### Step III
## Evaluation
</textarea>
</section>

<section data-markdown>
        <textarea data-template>
### Machine Learning is all about Generalization

<img src='img/MELLI.jpg' height="500px">
            </textarea>
            </section>


<section data-markdown>
    <textarea data-template>
### Split known data into training and test

<img class='fragment' src='img/insurance/generalization.jpg' height="550px">

</textarea>
</section>

<section data-markdown class="workshop exercise">
    <textarea data-template>
### Exercise on Paper #3 - How well did you generalize?

* Turn the page and redraw the lines you printed through from the first page
* Get an estimate of the misclassified samples on both diagrams
* What do you think, is this result worse?
* What would you have done differently if you had known this is all about generalization?

    </textarea>
        </section>


<section id='overfitting'>
        <h3>The Issue: Overfitting</h2>
    <div>
    <div style="float: left">
        <img src="img/elements/80_percent.jpg" height="200" class="fragment" data-fragment-index='1'>
        <p>
            <small><em>Training Score</em></small>
        </p>
    </div>
    <div style="float: left" class="fragment" data-fragment-index='5'>
        <img src="img/elements/down.jpg" height="200">
    </div>
    <div style="float: left" class="fragment" data-fragment-index='4'>
        <img src="img/elements/up.jpg" height="200">
    </div>
    <div style="float: left">
            <img src="img/elements/70_percent.jpg" height="225"  class="fragment" data-fragment-index='2'>
            <p>
                <small><em>Test Score</em></small>
            </p>
    </div>
    </div>
    <p style="clear: both" class="fragment" data-fragment-index='3'><em>Training and test scores clearly divert</em></p>

    </section>

    <section data-markdown>
        <textarea data-template>
### Regularization

_Process to counter overfitting_

Each ML strategy has its own means of Regularization, e.g.
* KNN: more neighbors
* Decision Trees: reduce depth, use ensembles
* SVM: gamma (how many support vectors to use) and cost (of misclassified data)
* NN: Dropout, Batch Normalization, Reduced Capacity, Reduced Training Time
            </textarea>
            </section>

<section data-markdown>
<textarea data-template>
### Hands-On: Colab Notebook Part II

_Regularize your Decision tree_

* Continue with your notebook from where you stopped
* Execute the rest of the notebook
* Change the maximum depth of the decision tree to fight overfitting
* What is your best depth?
* How do the decision boundaries change?
* What are your best scores? 

<small>

<a href='https://colab.research.google.com/github/djcordhose/ml-workshop/blob/master/notebooks/classic/dt-intro.ipynb'>
https://colab.research.google.com/github/djcordhose/ml-workshop/blob/master/notebooks/classic/dt-intro.ipynb
</a>
</small>
</textarea>
</section>

<section data-markdown class="workshop">
<textarea data-template>
### Remember the two sample solutions?

<img src='img/decision-boundaries/decision-boundaries-train.jpg'>
<small>
Are they the same? What is the key difference?
</small>
</textarea>
</section>

<section data-markdown class="workshop">
<textarea data-template>
### Now on test data

<img src='img/decision-boundaries/decision-boundaries-test.jpg'>
<small>
Which one is better? Why?
</small>
</textarea>
</section>

<section data-markdown>
        <textarea data-template>
## Wrapping it up


        </textarea>
    </section>

<section data-markdown style="font-size: xx-large" class="fragments">
        <textarea data-template>
### Challenges of Machine Learning

_Depending on what your background is, machine learning can have different challenges_
* coming from data science: treating your work like a software project
  * needs to go through different phases and cycles
  * one of them being production
* notebooks are great to try things out and produce results from data once
  * not the best tool when your project lives longer 
* coming from software development: data is the critical factor
  * if it is lacking in either quantity or quality you might get a working model at all 
  * the process of creating a good machine learning model is pretty different from standard processes in software development

            </textarea>
    </section>

<section data-markdown>
        <textarea data-template>
### Map: Finding your strategy

<img src='img/ML-strategy-helper.png' height="550px">


        </textarea>
    </section>

<section data-markdown>
<textarea data-template>
### Team exercise

_Find the right strategy for your project_

* Team up with your neighbors
* Find one o more projects to evaluate
* Use the map from the previous slide (ask instructor to put it up on the projector) 
* What might be the best approach?
* What questions do you still have about your project: Write them down and check then in the final part of this workshop

</textarea>
</section>
    
    </div>

</div>

<script src="reveal.js/js/reveal.js"></script>
<script src="lib/jquery-2.2.4.js"></script>

<script>
        $('section:not([data-background])').attr('data-background', "background/white.jpg");
    </script>
    <script>
        const isLocal = window.location.hostname.indexOf('localhost') !== -1 || 
                    window.location.hostname.indexOf('127.0.0.1') !== -1;
    
        if (isLocal && !printMode) {
        } else {
            // only applies to public version
                $('.todo').remove();
                $('.preparation').remove();
                $('.local').remove();
        }
    
        Reveal.addEventListener( 'ready', function( event ) {
            // applies to all versions
            $('code').addClass('line-numbers');
    
            $('.fragments li').addClass('fragment')
    
            // make all links open in new tab
            $('a').attr('target', '_blank')
    
            if (isLocal && !printMode) {
                // only applies to presentation version
                Reveal.configure({ controls: false });
            } else {
                // only applies to public version
                $('.fragment').removeClass('fragment');
            }
    
    
        } );
    </script>
    
<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        width: 1100,

        transition: 'fade', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'reveal.js/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'reveal.js/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'reveal.js/plugin/zoom-js/zoom.js', async: true},
            {src: 'reveal.js/plugin/notes/notes.js', async: true},
            // https://github.com/mikemiles86/reveal-line-numbers
            {src: 'lib/js/line-numbers.js'}
        ]
    });

</script>

</body>
</html>
